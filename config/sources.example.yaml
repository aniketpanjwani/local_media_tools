# Local Media Tools - Source Configuration
# =========================================
# Configure your event sources here. Run /research to scrape all enabled sources.
# User config location: ~/.config/local-media-tools/
# Database output: ~/.config/local-media-tools/data/events.db

newsletter:
  name: "My Local Events"      # Project name (used in output metadata)
  region: "Hudson Valley, NY"  # Target region for events

  # Formatting preferences for /write command
  # Describe in plain English how you want your newsletter formatted.
  # Claude will interpret these instructions when generating markdown.
  #
  # Available fields: title, venue, venue_city, date, day_of_week, formatted_date,
  #   time, description, category, price, ticket_url, event_url, source_url
  #
  # source_url = where the event was found (Instagram post, Facebook event, etc.)
  formatting_preferences: |
    Organize events by date with each day as a section header.
    Format dates like "Saturday, January 20".
    For each event, show: **Title** @ Venue | Time | Price
    Use emojis for categories: üéµ music, üé® art, üç¥ food, üé≠ theater.
    Keep descriptions to 1-2 sentences max.
    Include [Get Tickets](ticket_url) links when available.
    Include [Source](source_url) for attribution.

  # Alternative formatting examples:
  #
  # Minimal style:
  # formatting_preferences: |
  #   Organize by date. Simple formatting, no emojis.
  #   Just event name, venue, and time.
  #
  # With source attribution:
  # formatting_preferences: |
  #   Format: **Title** @ Venue | Time
  #   Add [See post](source_url) link after each event.
  #
  # By category:
  # formatting_preferences: |
  #   Organize by category (Music, Art, Food, Community).
  #   Within each category, sort by date.
  #   Use bullet points with essentials only.

# ============================================================================
# SOURCES
# ============================================================================

sources:
  # --------------------------------------------------------------------------
  # INSTAGRAM
  # Scrapes public Instagram profiles for event announcements.
  # Requires: SCRAPECREATORS_API_KEY in .env
  # --------------------------------------------------------------------------
  instagram:
    enabled: true
    accounts:
      # Music venue example - live performances
      - handle: "local_venue"        # Instagram handle (without @)
        name: "Local Venue"          # Display name for output
        type: "music_venue"          # Type: music_venue, bar, restaurant, gallery, theater
        location: "Kingston, NY"     # City/location (helps with deduplication)
        notes: "Live music Wed-Sun"  # Optional notes for reference

      # Aggregator example - account that posts about multiple venues
      - handle: "events_aggregator"
        name: "Events Aggregator"
        type: "aggregator"           # Type: aggregator (posts about many venues)
        location: "Hudson Valley"

      # Promoter example - throws events at various venues
      # - handle: "local_promoter"
      #   name: "Local Promoter"
      #   type: "promoter"
      #   location: "Hudson Valley"

    # Priority handles appear first in output (optional)
    priority_handles:
      - "local_venue"

  # --------------------------------------------------------------------------
  # FACEBOOK
  # Facebook events are not configured here. Instead, pass event URLs directly
  # to the /research command or during the research skill conversation.
  # Example: /research https://facebook.com/events/123456
  # --------------------------------------------------------------------------

  # --------------------------------------------------------------------------
  # WEB AGGREGATORS
  # Scrapes event listing websites using Firecrawl.
  # Requires: FIRECRAWL_API_KEY in .env
  #
  # How it works:
  # 1. Firecrawl discovers event page URLs from your base URL
  # 2. URLs are filtered by event_url_pattern (if set)
  # 3. Each event page is scraped to markdown
  # 4. Claude extracts event details from the markdown
  # 5. Scraped URLs are tracked to avoid re-scraping (incremental)
  #
  # Configuration fields:
  # | Field             | Type    | Default   | Description                               |
  # |-------------------|---------|-----------|-------------------------------------------|
  # | url               | string  | required  | Base URL of the event listing site        |
  # | name              | string  | required  | Display name for this source              |
  # | source_type       | enum    | "listing" | Site type (informational only):           |
  # |                   |         |           | - listing: general event list             |
  # |                   |         |           | - calendar: date-organized events         |
  # |                   |         |           | - venue: single venue's schedule          |
  # | max_pages         | int     | 50        | Max event URLs to discover (1-200)        |
  # | event_url_pattern | string  | null      | Glob pattern to filter URLs:              |
  # |                   |         |           | - "/events/*" matches /events/jazz-night  |
  # |                   |         |           | - "/*/event/*" matches /2025/event/123    |
  # | extraction_hints  | string  | null      | Instructions for Claude's extraction      |
  # --------------------------------------------------------------------------
  web_aggregators:
    enabled: true
    sources: []
    # Example configurations:
    #
    # Event listing site (list of events on one or more pages)
    # - url: "https://hudsonvalleyevents.com"
    #   name: "Hudson Valley Events"
    #   source_type: "listing"
    #   max_pages: 50
    #
    # Calendar-style site (events organized by date)
    # - url: "https://localcalendar.com/events"
    #   name: "Local Calendar"
    #   source_type: "calendar"
    #   event_url_pattern: "/event/*"   # Only scrape URLs matching this pattern
    #   max_pages: 30
    #
    # Venue site (single venue's event page)
    # - url: "https://thevenue.com/schedule"
    #   name: "The Venue"
    #   source_type: "venue"
    #   extraction_hints: "Events are in table rows with date, artist, and time columns"
    #
    # Site with auto-discovered profile (created by /add-source):
    # - url: "https://www.iloveny.com/events/"
    #   name: "I Love NY"
    #   source_type: "listing"
    #   max_pages: 50
    #   profile:
    #     discovery_method: "crawl"          # map failed, use crawl instead
    #     crawl_depth: 2
    #     event_url_regex: "/event/[^/]+/\\d+/?$"  # Learned from examples
    #     sample_event_urls:
    #       - "/event/a-frosty-fest/76214/"
    #       - "/event/lumina-a-magical-light-experience/76396/"
    #     notes: "Statewide coverage. Events have numeric IDs."
    #     profiled_at: "2025-01-15T10:30:00"
    #
    # JavaScript-heavy site (e.g., Eventbrite) - needs wait_for:
    # - url: "https://www.eventbrite.com/d/canada--winnipeg/events/"
    #   name: "Eventbrite Winnipeg"
    #   source_type: "listing"
    #   max_pages: 50
    #   profile:
    #     discovery_method: "scrape_wait_for"  # JS site, needs wait for render
    #     event_url_regex: "/e/[^/]+-tickets-\\d+"
    #     notes: "Eventbrite uses JS rendering, map returns 0 URLs."
    #
    # To manually refresh an event page after it's been scraped:
    #   /newsletter-events:update-event https://hvmag.com/events/jazz-night

  # --------------------------------------------------------------------------
  # EVENTBRITE (Future)
  # --------------------------------------------------------------------------
  eventbrite:
    enabled: false
    organizers: []

# ============================================================================
# FILTERS
# ============================================================================

filters:
  date_range:
    start: "today"     # Start date for event filtering
    end: "+7days"      # End date (relative or absolute)
  categories: []       # Empty = all categories
  exclude_keywords:    # Skip events containing these words
    - "cancelled"
    - "postponed"
    - "rescheduled"

# ============================================================================
# STORAGE
# ============================================================================

storage:
  backend: sqlite      # sqlite (default) or json (legacy)
  # path: ~/.config/local-media-tools/data/events.db  # Default, can override
  auto_backup: true    # Backup before migrations
